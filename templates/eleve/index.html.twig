{% extends 'base.html.twig' %}

{% block title %}Eleve index{% endblock %}

{% block body %}
    <h1 class="page-title">Liste des élèves</h1>

    <br>
    <br>

<form method="get" action="" style="margin-bottom:20px; display:flex; gap:10px;">
    <input 
        type="text"
        name="q"
        placeholder="Rechercher..."
        value="{{ app.request.get('q') }}"
        class="form-control"
        style="max-width:300px;"
    >
    <button type="submit" class="btn btn-primary">
        Rechercher
    </button>
</form>



    <table class="table">
        <thead>
            <tr>
                <th>Nom</th>
                <th>Prenom</th>
                <th>Copos</th>
                <th>Ville</th>
                <th>Tel</th>
                <th>Mail</th>
                <th>Responsable 1</th>
                <th>actions</th>
                

            </tr>
        </thead>
        <tbody>
        
        {% for eleve in eleves %}
            {# On met le onclick directement sur la balise TR unique #}
            <tr onclick="window.location='{{ path('app_eleve_show', {'id': eleve.id}) }}'" style="cursor: pointer;">
                <td>{{ eleve.nom }}</td>
                <td>{{ eleve.prenom }}</td>  
                <td>{{ eleve.copos }}</td>
                <td>{{ eleve.ville }}</td>
                <td>{{ eleve.tel }}</td>
                <td>{{ eleve.mail }}</td>
                
                {# Correction de la balise <<td> qui était mal écrite #}
                <td>
                    {{ eleve.responsables|length > 0 ? eleve.responsables[0].nom : '' }}
                    {{ eleve.responsables|length > 0 ? eleve.responsables[0].prenom : '' }}
                </td>
                
                {# Attention : cliquer sur ces boutons déclenchera aussi le clic de la ligne #}
                {# Pour éviter ça, il faudrait du Javascript (stopPropagation), mais ça marchera quand même #}
                <td>
                    
                    <a href="{{ path('app_eleve_edit', {'id': eleve.id}) }}" class="btn btn-sm btn-warning">edit</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="8">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}